<div *ngIf="isLoading; else content">
  <div class="flex items-center justify-center h-screen">
    <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-blue-500"></div>
  </div>  
</div>

<ng-template #content>
  <front-end-internship-assignment-navbar/>
  <div class="p-4 sm:ml-64 mt-20" *ngIf="allResults.length > 0; else nodata" >
    <div class="tw-mb-24-px tw-text-24-px"> Book{{ allResults.length > 1 ? "s" : "" }} based on search "{{ subjectName }}"</div>
  
    <ng-container>
      <table class="table-view">
        <thead>
          <tr class="table-row">
            <th class="header">Title and Sub Title</th>
            <th class="header">Author</th>
            <th class="header">First Publish Year</th>
          </tr>
        </thead>
        <tbody class="table-body">
          <tr *ngFor="let book of getPaginatedResults()" class="row-data">
            <td>
              <a class="tw-no-underline" href="https://openlibrary.org{{ book.key }}" target="_blank">{{ book.title }}</a>
            </td>
            <td>
              {{ book.author_name ? book.author_name.join(", ") : "N/A" }}
            </td>
            <td>{{ book.first_publish_year ? book.first_publish_year : "N/A" }}</td>
          </tr>
        </tbody>
      </table>
      <p class="mt-3">Page: {{ currentPage }} / {{getTotalPages()}} </p>
      <br>
      <button class="px-4 py-2 bg-blue-500 text-white rounded-md mr-2 mb-4"
      (click)="goToPreviousPage()" 
      [disabled]="currentPage === 1">Previous</button>

      <button class="px-4 py-2 bg-blue-500 text-white rounded-md" 
      (click)="goToNextPage()" 
      [disabled]="currentPage === getTotalPages()">Next</button>

    </ng-container>
  </div>
  <ng-template #nodata>
    <div class="flex items-center justify-center h-full p-4 sm:ml-64" style="margin-top: -80px;">
      <div class="text-center">
        <h2 class="text-2xl font-bold mb-4">No Data Found</h2>
        <p class="text-gray-500">Sorry, no data was found. Visit <a style="color: blue;" routerLink="/">Home</a> </p>
      </div>
    </div>
  </ng-template>
</ng-template>
  